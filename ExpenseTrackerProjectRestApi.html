<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        form {
            text-align: center;
            
        }
        body{
            background-image: url("https://img.freepik.com/free-vector/laptop-with-program-code-isometric-icon-software-development-programming-applications-dark-neon_39422-971.jpg?size=626&ext=jpg");
            background-size:cover;
        }
        h1{
            text-align: center;
        }
    </style>
</head>

<html>
    <body>
        <form onsubmit="SaveToLocalStorage(event)" autocomplete="on">
            
            <h1> EXPENSE TRACKER</h1>
            <label>Choose Expenses</label>
            <input type="number" id="num" name="number" required>
            <label>Choose Description</label>
            <input type="text" id="desc" name="description" required>
            <label>Choose Category</label>
            <select  id="categ" name="cetegory" required>
                <option value="Shopping">Shopping</option>
                <option value="Travelling">Travelling</option>
                <option value="Food">Food</option>
                <option value="Party">Party</option>
            </select><br>
            <br>

            <button>Add expenses</button>


        </form>
        <ul id= "No of Expenses"></ul>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.1.3/axios.min.js"></script>
        <script>
            function SaveToLocalStorage(event){
                event.preventDefault();
                const Number=event.target.number.value
                const Description=event.target.description.value
                const Cetegory=event.target.cetegory.value
                const obj = {
                    Number,
                    Description,
                    Cetegory

                }
            axios.post("https://crudcrud.com/api/bf06fc2c7e3b402089baafec521e4a0e/ExpensesData",obj)
            .then( (response) =>{
                DisplayOnScreen(response.data)
                console.log(response)
            }).catch((err)=>{
                console.log(err)
            })
                
            }
            window.addEventListener("DOMContentLoaded", () => {

                axios.get("https://crudcrud.com/api/bf06fc2c7e3b402089baafec521e4a0e/ExpensesData")
                .then((response) =>{
                    console.log(response)
                    for(let i=0;i<response.data.length;i++){
                        DisplayOnScreen(response.data[i])
                    }
                }).catch((err)=>
                console.log(err))
            })
            
            
            function DisplayOnScreen(User){
                const parentNode = document.getElementById("No of Expenses")
                const childNode = `<li id=${User._id}> .${User.Number}- ${User.Description}-,${User.Cetegory}
                    <button onclick=deleteExpenses('${User._id}')>Delete Expenses</button>
                    <button onclick=editExepnses('${User.Number}','${User.Description}','${User.Cetegory}','${User._id}')>Edit</button></li>`
                parentNode.innerHTML = parentNode.innerHTML + childNode// to add the child node in to ul parent node
            }
            function editExepnses(number,description,cetegory,UserId){
                document.getElementById('num').value = number
                document.getElementById('desc').value= description
                document.getElementById('categ').value = cetegory
                deleteExpenses(UserId)


                
                   }
            function deleteExpenses(UserId){
                axios.delete(`https://crudcrud.com/api/bf06fc2c7e3b402089baafec521e4a0e/ExpensesData/${UserId}`)
                removeExpenseFromScreen(UserId)

            }
            function removeExpenseFromScreen(UserId){
                const parentNode = document.getElementById("No of Expenses")
                const childNodeTOdeleted=document.getElementById(UserId)
                parentNode.removeChild(childNodeTOdeleted)
            }
            
        </script>

    </body>
</html>

